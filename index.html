<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card Memorizer</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState } = React;
        
        const Shuffle = () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="16 3 21 3 21 8"></polyline>
                <line x1="4" y1="20" x2="21" y2="3"></line>
                <polyline points="21 16 21 21 16 21"></polyline>
                <line x1="15" y1="15" x2="21" y2="21"></line>
                <line x1="4" y1="4" x2="9" y2="9"></line>
            </svg>
        );
        
        const RotateCcw = () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="1 4 1 10 7 10"></polyline>
                <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
            </svg>
        );
        
        const Layers = () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polygon points="12 2 2 7 12 12 22 7 12 2"></polygon>
                <polyline points="2 17 12 22 22 17"></polyline>
                <polyline points="2 12 12 17 22 12"></polyline>
            </svg>
        );

        const SUITS = {
          spades: { glyph: '♠', color: 'text-black' },
          hearts: { glyph: '♥', color: 'text-red-600' },
          diamonds: { glyph: '♦', color: 'text-red-600' },
          clubs: { glyph: '♣', color: 'text-black' }
        };

        const RANKS = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];

        const generateOrderedDeck = () => {
          const deck = [];
          ['spades', 'hearts', 'diamonds', 'clubs'].forEach(suit => {
            RANKS.forEach(rank => {
              deck.push({ rank, suit, id: `${rank}-${suit}` });
            });
          });
          return deck;
        };

        const CardView = ({ card, scale = 1 }) => {
          const suitInfo = SUITS[card.suit];
          const baseWidth = 120;
          const baseHeight = 160;
          const width = baseWidth * scale;
          const height = baseHeight * scale;
          
          return (
            <div 
              className="bg-white rounded-lg shadow-md border border-gray-300 relative flex-shrink-0"
              style={{ width: `${width}px`, height: `${height}px` }}
            >
              <div className="absolute top-1 left-1.5">
                <div className={`font-bold ${suitInfo.color}`} style={{ fontSize: `${14 * scale}px` }}>{card.rank}</div>
                <div className={suitInfo.color} style={{ fontSize: `${12 * scale}px` }}>{suitInfo.glyph}</div>
              </div>
              <div 
                className={`absolute ${suitInfo.color}`}
                style={{ 
                  fontSize: `${48 * scale}px`,
                  top: '50%',
                  left: '50%',
                  transform: 'translate(-50%, -50%)'
                }}
              >
                {suitInfo.glyph}
              </div>
              <div className="absolute bottom-1 right-1.5 text-right">
                <div className={`font-bold ${suitInfo.color}`} style={{ fontSize: `${14 * scale}px` }}>{card.rank}</div>
                <div className={suitInfo.color} style={{ fontSize: `${12 * scale}px` }}>{suitInfo.glyph}</div>
              </div>
            </div>
          );
        };

        const CardBack = ({ onClick }) => (
          <div 
            onClick={onClick}
            className="bg-gradient-to-br from-gray-300 to-gray-100 rounded-lg border border-gray-400 cursor-pointer hover:shadow-lg transition-shadow flex items-center justify-center active:scale-95 flex-shrink-0"
            style={{ width: '120px', height: '160px' }}
          >
            <div className="text-gray-500 text-xs opacity-60">♣ ♦ ♠ ♥</div>
          </div>
        );

        const EmptySlot = ({ label, scale = 1 }) => {
          const width = 120 * scale;
          const height = 160 * scale;
          
          return (
            <div 
              className="border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center flex-shrink-0"
              style={{ width: `${width}px`, height: `${height}px` }}
            >
              <span className="text-xs text-gray-400">{label}</span>
            </div>
          );
        };

        function CardMemorizer() {
          const initialDeck = generateOrderedDeck();
          
          const [faceDown, setFaceDown] = useState(initialDeck);
          const [faceUp, setFaceUp] = useState([]);
          const [includedSuits, setIncludedSuits] = useState(new Set(['spades', 'hearts', 'diamonds', 'clubs']));
          const [faceCardsOnly, setFaceCardsOnly] = useState(false);
          const [groupByThree, setGroupByThree] = useState(false);
          const [currentGroup, setCurrentGroup] = useState([]);

          const rebuildDeck = (suits, faceOnly) => {
            let filtered = initialDeck.filter(card => suits.has(card.suit));
            if (faceOnly) {
              filtered = filtered.filter(card => ['J', 'Q', 'K'].includes(card.rank));
            }
            setFaceDown(filtered);
            setFaceUp([]);
            setCurrentGroup([]);
          };

          const flipTopCard = () => {
            if (faceDown.length === 0) return;
            
            const card = faceDown[faceDown.length - 1];
            setFaceDown(prev => prev.slice(0, -1));
            setFaceUp(prev => [...prev, card]);
            
            if (groupByThree) {
              setCurrentGroup(prev => {
                if (prev.length === 3) {
                  return [card];
                }
                return [...prev, card];
              });
            }
          };

          const shuffleFaceDown = () => {
            setFaceDown(prev => {
              const shuffled = [...prev];
              for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
              }
              return shuffled;
            });
          };

          const replaceAll = () => {
            setFaceDown(prev => [...prev, ...faceUp.slice().reverse()]);
            setFaceUp([]);
            setCurrentGroup([]);
          };

          const reset = () => {
            setIncludedSuits(new Set(['spades', 'hearts', 'diamonds', 'clubs']));
            setFaceCardsOnly(false);
            setGroupByThree(false);
            setFaceDown(initialDeck);
            setFaceUp([]);
            setCurrentGroup([]);
          };

          const toggleSuit = (suit) => {
            const newSuits = new Set(includedSuits);
            if (newSuits.has(suit)) {
              newSuits.delete(suit);
            } else {
              newSuits.add(suit);
            }
            setIncludedSuits(newSuits);
            rebuildDeck(newSuits, faceCardsOnly);
          };

          const toggleFaceCards = () => {
            const newValue = !faceCardsOnly;
            setFaceCardsOnly(newValue);
            rebuildDeck(includedSuits, newValue);
          };

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4 pb-8">
              <div className="max-w-md mx-auto">
                <h1 className="text-3xl font-bold text-center text-gray-800 mb-6">Card Memorizer</h1>
                
                <div className="flex justify-center gap-8 mb-6">
                  <div className="flex flex-col items-center gap-2">
                    <span className="text-sm font-medium text-gray-600">Deck</span>
                    {faceDown.length > 0 ? (
                      <CardBack onClick={flipTopCard} />
                    ) : (
                      <EmptySlot label="empty" scale={1} />
                    )}
                    <span className="text-xs text-gray-500">{faceDown.length} cards</span>
                  </div>

                  <div className="flex flex-col items-center gap-2">
                    <span className="text-sm font-medium text-gray-600">Face-up</span>
                    {faceUp.length > 0 ? (
                      <CardView card={faceUp[faceUp.length - 1]} scale={1} />
                    ) : (
                      <EmptySlot label="empty" scale={1} />
                    )}
                    <span className="text-xs text-gray-500">{faceUp.length} flipped</span>
                  </div>
                </div>

                <div className="flex justify-center gap-2 mb-5">
                  <button
                    onClick={shuffleFaceDown}
                    className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 active:bg-blue-800 transition-colors shadow-md text-sm"
                  >
                    <Shuffle />
                    Shuffle
                  </button>
                  <button
                    onClick={replaceAll}
                    className="flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 active:bg-gray-800 transition-colors shadow-md text-sm"
                  >
                    <Layers />
                    Replace All
                  </button>
                  <button
                    onClick={reset}
                    className="flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 active:bg-gray-800 transition-colors shadow-md text-sm"
                  >
                    <RotateCcw />
                    Reset
                  </button>
                </div>

                <div className="grid grid-cols-2 gap-2 mb-4 px-2">
                  {Object.entries(SUITS).map(([suit, info]) => (
                    <button
                      key={suit}
                      onClick={() => toggleSuit(suit)}
                      className={`flex items-center justify-center gap-2 px-3 py-2.5 rounded-lg border-2 transition-all active:scale-95 ${
                        includedSuits.has(suit)
                          ? 'bg-white border-blue-500 shadow-md'
                          : 'bg-gray-200 border-gray-300'
                      }`}
                    >
                      <span className={`text-2xl ${info.color}`}>{info.glyph}</span>
                      <span className="text-sm capitalize font-medium">{suit}</span>
                    </button>
                  ))}
                </div>

                <div className="flex justify-center mb-3">
                  <button
                    onClick={toggleFaceCards}
                    className={`w-full max-w-xs px-6 py-3 rounded-lg border-2 transition-all active:scale-95 ${
                      faceCardsOnly
                        ? 'bg-blue-600 text-white border-blue-600 shadow-md'
                        : 'bg-white text-gray-700 border-gray-300 shadow-sm'
                    }`}
                  >
                    <span className="font-medium">Face Cards Only</span>
                    <span className="text-sm opacity-70 ml-2">(J, Q, K)</span>
                  </button>
                </div>

                <div className="flex justify-center mb-6">
                  <button
                    onClick={() => {
                      setGroupByThree(!groupByThree);
                      if (groupByThree) {
                        setCurrentGroup([]);
                      }
                    }}
                    className={`w-full max-w-xs px-6 py-3 rounded-lg border-2 transition-all active:scale-95 ${
                      groupByThree
                        ? 'bg-blue-600 text-white border-blue-600 shadow-md'
                        : 'bg-white text-gray-700 border-gray-300 shadow-sm'
                    }`}
                  >
                    <span className="font-medium">Group by Three</span>
                  </button>
                </div>

                {groupByThree && (
                  <div className="bg-white rounded-lg shadow-lg p-4">
                    <h3 className="text-sm font-medium text-gray-600 text-center mb-3">Current Group</h3>
                    <div className="flex justify-center gap-2">
                      {currentGroup.map(card => (
                        <CardView key={card.id} card={card} scale={0.7} />
                      ))}
                      {[...Array(Math.max(0, 3 - currentGroup.length))].map((_, i) => (
                        <EmptySlot key={`empty-${i}`} label="" scale={0.7} />
                      ))}
                    </div>
                  </div>
                )}
              </div>
            </div>
          );
        }

        ReactDOM.render(<CardMemorizer />, document.getElementById('root'));
    </script>
</body>
</html>
